<div>
	<div class="row page-header">
		<div class="col-xs-12 col-md-12">
			<h1 jhiTranslate="label-printing.title">
				EXPORT DATA / LABEL PRINTING <a class="bms-fa-question-circle fbk-help" data-help-link="MAKE_LABELS"></a>
			</h1>
		</div>
	</div>
	<div class="row">
		<div class="col-xs-12 col-md-12">
			<div class="panel panel-default">
				<div class="panel-body">
					<div class="col-xs-12 col-md-12">

						<div class="row">
							<div class="col-xs-12 col-md-12">
								<h2 *ngIf="isLabelPrinting()" jhiTranslate="label-printing.header.print.labels">Print labels</h2>
								<h2 *ngIf="!isLabelPrinting()" jhiTranslate="label-printing.header.export.data">Export data</h2>
							</div>
						</div>

						<div class="row lblprnt-study-details" *ngIf="hasHeader()">
							<div class="col-xs-6 col-md-6">
								<h2 class="sub-content-heading" jhiTranslate="label-printing.selected.study">Selected study</h2>
								<div *ngIf="metadata else loading">
									<div class="form-group" *ngFor="let key of metadataKeys">
										<label class="control-label">
											<strong>{{key}}</strong>:
										</label>
										<span>{{metadata.get(key)}}</span>
									</div>
								</div>
							</div>
							<div class="col-xs-6 col-md-6" *ngIf="isLabelPrinting() && labelsNeededSummary else loading">
								<div class="row">
									<div class="col-xs-12 col-md-12">
										<h2 class="sub-content-heading" jhiTranslate="label-printing.summary.of.labels.needed">
											SUMMARY OF LABELS NEEDED</h2>
									</div>
								</div>
								<div class="row">
									<div class="col-xs-12 col-md-12">
										<table class="table table-curved table-condensed">
											<thead>
											<tr>
												<th *ngFor="let header of labelsNeededSummary.headers">{{header}}</th>
											</tr>
											</thead>
											<tbody>
											<tr *ngFor="let row of labelsNeededSummary.values; odd as odd; even as even">
												<td *ngFor="let header of labelsNeededSummary.headers"
													[ngClass]="{ odd: odd, even: even }">{{row[header]}}</td>
											</tr>
											</tbody>
										</table>
									</div>
								</div>
								<div class="row">
									<div class="col-xs-12 col-md-12 text-right">
										<label class="control-label label-bold" jhiTranslate="label-printing.total.number.of.labels">
											Total # of Labels to Print</label>: &nbsp;
										<span>{{labelsNeededSummary.totalNumberOfLabelsNeeded}}</span>
									</div>
								</div>
							</div>
						</div>

						<div class="row">
							<div class="col-xs-6 col-md-6">
								<div class="row">
									<div class="col-xs-12 col-md-12">
										<h2 class="sub-content-heading" jhiTranslate="label-printing.preset.heading">
											Preset options
										</h2>
									</div>
									<div class="col-xs-12 col-md-12 form-group">
										<div class="row">
											<label class="control-label add_top_padding col-xs-4 col-md-4">
												<input type="checkbox" [(ngModel)]="loadSavedSettings" name="loadSavedSettings" checked=""/>Load saved settings:</label>
											<div class="col-xs-8 col-md-6" style="padding-left: 0px;">
												<select *ngIf="loadSavedSettings" class="form-control" [(ngModel)]="presetSettingId" (ngModelChange)="applySelectedSetting()">
													<option [value]="0">Please Choose</option>
													<option *ngFor="let presetSetting of presetSettings" [value]="presetSetting.id">{{presetSetting.name}}</option>
												</select>
											</div>
											<div class="add_top_padding saved-settings pull-left fbk-left-padding">
												<a *ngIf="loadSavedSettings &&  presetSettingId!=0" href="javascript: void(0);" class="fb-delete-settings"><span
													class="glyphicon glyphicon-trash" (click)="deleteSelectedSetting()"></span></a>
											</div>
										</div>
									</div>
								</div>
							</div>
							<div class="col-xs-6 col-md-6">
								<div class="row">
									<div class="col-xs-12 col-md-12">
										<h2 class="sub-content-heading" jhiTranslate="label-printing.choose.output">
											CHOOSE OUTPUT
										</h2>
									</div>
									<div class="col-xs-12 col-md-12">
										<label class="control-label " jhiTranslate="label-printing.choose.format">
											Choose the format you would like to use:</label>
									</div>
									<div class="col-xs-12 col-md-12 form-group">
										<div class="row">
											<label class="control-label add_top_padding col-xs-4 col-md-4">
												<strong jhiTranslate="label-printing.output.format"></strong>:</label>
											<div class="col-xs-8 col-md-7">
												<select class="form-control" [(ngModel)]="fileType" (ngModelChange)="reset()">
													<option [value]="FILE_TYPES.NONE">Please Choose</option>
													<option [value]="FILE_TYPES.PDF">Formatted PDF Label Sheets</option>
													<option *ngIf="isExcelEnabled()" [value]="FILE_TYPES.EXCEL">Excel Data</option>
													<option *ngIf="!isExcelEnabled()" [value]="FILE_TYPES.EXCEL" disabled>Excel Data (not available)</option>
													<option [value]="FILE_TYPES.CSV">CSV Data</option>
												</select>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div *ngIf="fileType === FILE_TYPES.PDF">
							<div class="row">
								<div class="col-xs-12 col-md-12">
									<h2 class="sub-content-heading" jhiTranslate="label-printing.specify.label.stock">
									</h2>
								</div>
							</div>
							<div class="row">
								<div class="col-xs-6 col-md-6">
									<div class="row form-group">
										<div class="col-xs-12 col-md-12">
											<label class="control-label " jhiTranslate="label-printing.enter.specs.for.label"></label>
										</div>
									</div>
									<div class="row form-group">
										<div class="col-xs-7 col-md-7">
											<label class="control-label label-bold">
												<strong jhiTranslate="label-printing.size.of.label.sheet"></strong>:</label>
										</div>
										<div class="col-xs-5 col-md-5">
											<select [(ngModel)]="labelPrintingData.sizeOfLabelSheet" class="form-control">
												<option value="1" jhiTranslate="label-printing.label.size.a4">A4</option>
												<option value="2" jhiTranslate="label-printing.label.size.letter">Letter</option>
											</select>
										</div>
									</div>

									<div class="row form-group">
										<div class="col-xs-7 col-md-7">
											<label class="control-label label-bold">
												<strong jhiTranslate="label-printing.number.of.rows.per.page"></strong>:</label>
										</div>
										<div class="col-xs-5 col-md-5">
											<select [(ngModel)]="labelPrintingData.numberOfRowsPerPage" class="form-control">
												<option value="7">7</option>
												<option value="8">8</option>
												<option value="10">10</option>
											</select>
										</div>
									</div>
								</div>
								<div class="col-xs-6 col-md-6">
									<div class="form-group">
										<div class="col-xs-12 col-md-12">&nbsp;</div>
										<div class="col-xs-12 col-md-12">
											<br/>
											<em jhiTranslate="label-printing.specify.label.details.message"></em>
										</div>
									</div>
								</div>
							</div>
						</div>
						<div class="label-printing-details" *ngIf="fileType">
							<div class="row">
								<div class="col-xs-12 col-md-12">
									<h2 class="sub-content-heading" jhiTranslate="label-printing.choose.fields">
										CHOOSE FIELDS
									</h2>
									<div class="row">
										<label class="control-label add_top_padding col-xs-12 col-md-12" [innerHTML]="getChooseLabelDescription()"></label>
									</div>
								</div>
							</div>
							<div class="row add_top_padding">
								<div class="col-xs-12 col-md-12">
									<div class="form-group">
										<div class="row">
											<div class="col-xs-6 col-md-6">
												<div class="row">
													<!-- Usually there are two columns
														 To simplify we split it in two and if there are more (rare)
														 the following ones will just accommodate -->
													<div ngClass="col-xs-6 col-md-6"
														 *ngFor="let labelType of labelTypes">
														<div class="label-type-list">
															<ul class="list-group field-group">
																<li class="list-group-item">
																	<label class="control-label label-bold text-truncate">
																		{{labelType.title}}
																	</label>
																</li>
															</ul>
															<ul id="label-type-fields" class="list-group droppable availableFields"
																[attr.data-label-type-key]="labelType.key">
																<li class="list-group-item text-truncate" *ngFor="let item of labelType.fields"
																	[attr.id]="item.id"
																	[attr.data-label-type-key]="labelType.key">{{item.name}}</li>
															</ul>
														</div>
													</div>
												</div>
											</div>
											<div class="col-xs-6 col-md-6">
												<div class="row">
													<div class="col-xs-6 col-md-6">
														<ul class="list-group field-group">
															<li class="list-group-item">
																<label class="control-label label-bold" *ngIf="fileType === FILE_TYPES.PDF"
																	   jhiTranslate="label-printing.left.selected.fields">
																</label>
																<label class="control-label label-bold" *ngIf="fileType !== FILE_TYPES.PDF"
																	   jhiTranslate="label-printing.main.selected.fields">
																</label>
															</li>
														</ul>
														<ul id="leftSelectedFields" class="list-group droppable print-fields">
														</ul>
													</div>
													<div class="col-xs-6 col-md-6">
														<div *ngIf="fileType === FILE_TYPES.PDF">
															<ul class="list-group field-group">
																<li class="list-group-item">
																	<label class="control-label label-bold"
																		   jhiTranslate="label-printing.right.selected.fields">
																	</label>
																</li>
															</ul>
															<ul id="rightSelectedFields" class="list-group droppable print-fields">
															</ul>
														</div>
													</div>
												</div>
											</div>
										</div>
									</div>

								</div>
							</div>

							<!-- Barcodes section -->
							<div class="row" *ngIf="isLabelPrinting()">
								<div class="col-xs-12 col-md-12">
									<div class="row">
										<div class="col-xs-6 col-md-6">
											<h2 class="sub-content-heading" jhiTranslate="label-printing.barcode.options">
												Barcode Options
											</h2>
											<div class="form-group">
												<label class="control-label label-bold" jhiTranslate="label-printing.do.you.need.bar.codes">Do you need
													barcodes on your labels?</label>
												<label class="radio-inline" style="padding-left: 30px">
													<input type="radio" name="barcodeNeededRadio" [value]="true"
														   [(ngModel)]="labelPrintingData.barcodeNeeded"/>
													<span jhiTranslate="label-printing.do.you.need.bar.codes.yes">Yes</span>
												</label>
												<label class="radio-inline">
													<input checked="checked" type="radio" name="barcodeNeededRadio" [value]="false"
														   [(ngModel)]="labelPrintingData.barcodeNeeded"/>
													<span jhiTranslate="label-printing.do.you.need.bar.codes.no">No</span>
												</label>
											</div>
											<div class="form-group" *ngIf="labelPrintingData.barcodeNeeded">
												<label class="control-label label-bold"
													   jhiTranslate="label-printing.do.you.want.automatically.unique.bar.codes">
													Do you want to use automatically generated unique barcodes?</label>
												<label class="radio-inline" style="padding-left: 30px">
													<input checked="checked" type="radio" name="barcodeGeneratedAutomaticallyRadio"
														   [value]="true" [(ngModel)]="labelPrintingData.barcodeGeneratedAutomatically"/>
													<span jhiTranslate="common.form.yes.text">Yes</span>
												</label>
												<label class="radio-inline">
													<input type="radio" [value]="false" name="barcodeGeneratedAutomaticallyRadio"
														   [(ngModel)]="labelPrintingData.barcodeGeneratedAutomatically"/>
													<span jhiTranslate="common.form.no.text">No</span>
												</label>
											</div>
										</div>
										<div class="col-xs-6 col-md-6" *ngIf="labelPrintingData.barcodeNeeded && !labelPrintingData.barcodeGeneratedAutomatically">
											<div>
												<label class="control-label" jhiTranslate="label-printing.bar.code.note"></label>
											</div>
											<div class="form-group row">
												<div class="col-xs-4 col-md-4">
													<label class="control-label label-bold add_top_padding"
														   jhiTranslate="label-printing.first.bar.code.field"></label>:
												</div>
												<div class="col-xs-8 col-md-8">
													<select [(ngModel)]="labelPrintingData.firstBarcodeField" class="form-control">
														<option [value]="0" jhiTranslate="label-printing.bar.code.please.choose.field">Please choose</option>
														<option *ngFor="let field of labelTypesOrig | allLabels" [value]="field.id">
															{{field.name}}
														</option>
													</select>
												</div>
											</div>
											<div class="form-group row">
												<div class="col-xs-4 col-md-4">
													<label class="control-label label-bold add_top_padding"
														   jhiTranslate="label-printing.second.bar.code.field"></label>:
												</div>
												<div class="col-xs-8 col-md-8">
													<select [(ngModel)]="labelPrintingData.secondBarcodeField" class="form-control" >
														<option [value]="0" jhiTranslate="label-printing.bar.code.please.choose.field">Please choose</option>
														<option *ngFor="let field of labelTypesOrig | allLabels" [value]="field.id">
															{{field.name}}
														</option>
													</select>
												</div>
											</div>
											<div class="form-group row">
												<div class="col-xs-4 col-md-4">
													<label class="control-label label-bold add_top_padding"
														   jhiTranslate="label-printing.third.bar.code.field"></label>:
												</div>
												<div class="col-xs-8 col-md-8">
													<select [(ngModel)]="labelPrintingData.thirdBarcodeField" class="form-control">
														<option [value]="0" jhiTranslate="label-printing.bar.code.please.choose.field">Please choose</option>
														<option *ngFor="let field of labelTypesOrig | allLabels" [value]="field.id">
															{{field.name}}
														</option>
													</select>
												</div>
											</div>
										</div>
									</div>
								</div>
							</div> <!-- /Barcodes section -->

							<div class="row">
								<div class="col-xs-12 col-md-12">
									<div class="form-group">
										<div class="row">
											<div class="col-xs-6 col-md-6">
												<h2 class="sub-content-heading" jhiTranslate="label-printing.filename.description">
													Specify the name of the file
												</h2>
												<div class="row">
													<div class="col-xs-12 col-md-12">
														&nbsp;
													</div>
												</div>
												<div class="row">
													<div class="col-xs-3 col-md-3">
														<label class="control-label add_top_padding"><strong
															   jhiTranslate="label-printing.filename"></strong>:</label><span class="required">*</span>
													</div>
													<div class="col-xs-8 col-md-5">
														<input type="text" class="form-control" [(ngModel)]="labelPrintingData.filename"
															   placeholder="Filename"/>
													</div>
												</div>
											</div>
											<div class="col-xs-6 col-md-6">
												<h2 class="sub-content-heading" jhiTranslate="label-printing.save.preset.heading">
													Save settings
												</h2>
												<div>
													<label class="control-label"
														   jhiTranslate="label-printing.choose.preset.text"></label>
												</div>
												<div class="row">
														<label class="control-label add_top_padding col-xs-4 col-md-3"><strong
															   jhiTranslate="label-printing.save.preset.name.note"></strong>:</label>
													<div class="col-xs-8 col-md-5">
														<input type="text" class="form-control" [(ngModel)]="labelPrintingData.settingsName"
															   placeholder="Settings Name"/>
													</div>
												</div>
											</div>
										</div>
									</div>
								</div>
						</div> <!-- /label-printing-details -->
						</div>

						<div class="row">
							<div class="col-xs-12 col-md-12">
								&nbsp;
							</div>
						</div>

						<div class="row">
							<!-- Navigation Buttons -->
							<div class="form-group">
								<div class="col-xs-12 col-md-12 fbk-center">
									<input type="button" onclick="window.history.back();" value="Cancel" class="btn btn-default"/>
									<input type="button" *ngIf="fileType" id="fbk-lbl-printing-save-preset" (click)="savePresets()" value="Save Preset" class="btn btn-info"/>
									<input type="button" *ngIf="fileType" (click)="export()" value="Export" class="btn btn-primary" />
								</div>
							</div>
						</div>

						<div class="row">
							&nbsp;
						</div>

					</div>

				</div>
			</div>
		</div>
	</div>
</div>
<ng-template #loading>
	<div style=" display: flex; justify-content: center; align-items: center; ">
		<span class="throbber throbber-2x"></span>
	</div>
</ng-template>
<jhi-alert></jhi-alert>
<jhi-modal-confirm [modalTitle]="modalTitle" [modalMessage]="modalMessage" (onProceed)="proceed()"></jhi-modal-confirm>
